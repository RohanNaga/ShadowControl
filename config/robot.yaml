# Shadow Control Robot Configuration
# K-Scale Zeroth-01 with 16 STS3215 servos

robot:
  name: "shadow_control"
  platform: "zeroth-01"
  servo_count: 16

# Communication settings
serial:
  device: "/dev/ttyAMA5"  # Default Milk-V UART
  baudrate: 500000        # Reconfigured from 1Mbps default
  timeout: 0.1

# Servo configuration
# Note: Factory default is 1Mbps, must reconfigure to 500kbps
# Register value 1 = 500000 bps
servos:
  # Right Arm
  - id: 1
    name: "right_shoulder_pitch"
    keypoint_pair: [6, 8]  # right_shoulder to right_elbow
    min_angle: -90
    max_angle: 90
    offset: 0
    inverted: false

  - id: 2
    name: "right_shoulder_roll"
    keypoint_pair: [6, 8]
    min_angle: -45
    max_angle: 135
    offset: 0
    inverted: false

  - id: 3
    name: "right_elbow"
    keypoint_pair: [6, 8, 10]  # shoulder-elbow-wrist angle
    min_angle: 0
    max_angle: 150
    offset: 0
    inverted: false

  - id: 4
    name: "right_wrist"
    keypoint_pair: [8, 10]
    min_angle: -90
    max_angle: 90
    offset: 0
    inverted: false

  # Left Arm
  - id: 5
    name: "left_shoulder_pitch"
    keypoint_pair: [5, 7]  # left_shoulder to left_elbow
    min_angle: -90
    max_angle: 90
    offset: 0
    inverted: false

  - id: 6
    name: "left_shoulder_roll"
    keypoint_pair: [5, 7]
    min_angle: -135
    max_angle: 45
    offset: 0
    inverted: true

  - id: 7
    name: "left_elbow"
    keypoint_pair: [5, 7, 9]  # shoulder-elbow-wrist angle
    min_angle: 0
    max_angle: 150
    offset: 0
    inverted: false

  - id: 8
    name: "left_wrist"
    keypoint_pair: [7, 9]
    min_angle: -90
    max_angle: 90
    offset: 0
    inverted: false

  # Right Leg
  - id: 9
    name: "right_hip_pitch"
    keypoint_pair: [12, 14]  # right_hip to right_knee
    min_angle: -45
    max_angle: 90
    offset: 0
    inverted: false

  - id: 10
    name: "right_hip_roll"
    keypoint_pair: [12, 14]
    min_angle: -30
    max_angle: 30
    offset: 0
    inverted: false

  - id: 11
    name: "right_knee"
    keypoint_pair: [12, 14, 16]  # hip-knee-ankle angle
    min_angle: 0
    max_angle: 135
    offset: 0
    inverted: false

  - id: 12
    name: "right_ankle"
    keypoint_pair: [14, 16]
    min_angle: -30
    max_angle: 30
    offset: 0
    inverted: false

  # Left Leg
  - id: 13
    name: "left_hip_pitch"
    keypoint_pair: [11, 13]  # left_hip to left_knee
    min_angle: -45
    max_angle: 90
    offset: 0
    inverted: false

  - id: 14
    name: "left_hip_roll"
    keypoint_pair: [11, 13]
    min_angle: -30
    max_angle: 30
    offset: 0
    inverted: true

  - id: 15
    name: "left_knee"
    keypoint_pair: [11, 13, 15]  # hip-knee-ankle angle
    min_angle: 0
    max_angle: 135
    offset: 0
    inverted: false

  - id: 16
    name: "left_ankle"
    keypoint_pair: [13, 15]
    min_angle: -30
    max_angle: 30
    offset: 0
    inverted: false

# COCO keypoint indices for YOLOv8-pose
keypoints:
  nose: 0
  left_eye: 1
  right_eye: 2
  left_ear: 3
  right_ear: 4
  left_shoulder: 5
  right_shoulder: 6
  left_elbow: 7
  right_elbow: 8
  left_wrist: 9
  right_wrist: 10
  left_hip: 11
  right_hip: 12
  left_knee: 13
  right_knee: 14
  left_ankle: 15
  right_ankle: 16

# Safety limits
safety:
  max_velocity: 100  # degrees per second
  acceleration_limit: 500  # degrees per second^2
  position_threshold: 5  # degrees tolerance
  timeout_ms: 500  # Stop if no commands for this long

# Calibration home positions (servo encoder values)
calibration:
  home_position: 2048  # Center position (4096/2)
  calibrated: false
